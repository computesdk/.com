---
// Video.astro - A component for playing local video files

interface Props {
  src: string;
  title?: string;
  className?: string;
  autoPlay?: boolean;
  loop?: boolean;
  muted?: boolean;
  controls?: boolean;
  poster?: string;
}

const {
  src,
  title = "Video",
  className = "",
  autoPlay = false,
  loop = false,
  muted = true,
  controls = true,
  poster = "",
} = Astro.props;
---

<div class={`overflow-hidden rounded-lg shadow-xl ${className}`}>
  <div class="relative aspect-video w-full">
    <video
      class="h-full w-full object-cover"
      title={title}
      autoplay={autoPlay}
      loop={loop}
      muted={muted}
      controls={controls}
      poster={poster}
      playsinline
    >
      <source src={src} type={`video/${src.split(".").pop()}`} />
      Your browser does not support the video tag.
    </video>

    {
      !controls && (
        <div class="absolute inset-0 flex items-center justify-center">
          <button
            type="button"
            class="rounded-full bg-white/80 p-4 text-gray-900 shadow-lg transition-all hover:scale-110 hover:bg-white"
            aria-label="Play video"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-8 w-8"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                clip-rule="evenodd"
              />
            </svg>
          </button>
        </div>
      )
    }
  </div>
</div>

<style>
  /* Smooth hover effect for the play button */
  button {
    transition:
      transform 0.2s ease-in-out,
      background-color 0.2s ease-in-out;
  }

  /* Ensure video maintains aspect ratio */
  .aspect-video {
    aspect-ratio: 16 / 9;
  }

  /* Fallback for older browsers */
  @supports not (aspect-ratio: 16 / 9) {
    .aspect-video::before {
      float: left;
      padding-top: 56.25%;
      content: "";
    }
    .aspect-video::after {
      display: block;
      content: "";
      clear: both;
    }
  }
</style>
