---
// VideoEmbed.astro
interface Props {
  vimeoUrl: string;
  title?: string;
  className?: string;
}

const { vimeoUrl, title = "Video", className = "" } = Astro.props;

// Extract the video ID from Vimeo URL
const getVideoId = (url: string) => {
  const regExp = /vimeo\.com\/(?:video\/)?(\d+)/;
  const match = url.match(regExp);
  return match ? match[1] : null;
};

const videoId = getVideoId(vimeoUrl);

if (!videoId) {
  console.error("Invalid Vimeo URL provided");
}
---

<div class={`relative w-full ${className}`}>
  <div
    class="relative z-10 overflow-hidden rounded-lg border border-l-0 border-gray-200 bg-white shadow-xl dark:border-gray-700 dark:bg-gray-800"
  >
    <div class="relative aspect-video w-full overflow-hidden bg-black">
      {
        videoId ? (
          <iframe
            src={`https://player.vimeo.com/video/${videoId}?title=0&byline=0&portrait=0`}
            class="absolute left-0 top-0 h-full w-full"
            frameborder="0"
            allow="autoplay; fullscreen; picture-in-picture"
            allowfullscreen
            title={title}
          />
        ) : (
          <div class="flex h-full w-full items-center justify-center bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400">
            Invalid Vimeo URL
          </div>
        )
      }
    </div>
  </div>
</div>
